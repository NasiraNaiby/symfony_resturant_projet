{% extends 'main.html.twig' %}

{% block body  %}

<div class="container header">
    <div class="header-text mt-5 pt-4">
        <h1 class="fw-bold mt-5 pt-5 text-white">
            Votre Compte
        </h1>
    </div>
</div>
<section class="section-client">
<div class="container my-5 mt-3">
    <div class="row row-cols-1 row-cols-md-2 g-4 mt-3">
        <div class="col">
            <a href="#" id="editclientProfile">
                <div class="card h-100 client-card">
                    <div class="card-body text-center">
                    <i class="fas fa-user card-icon"></i>
                        <h5 class="card-title">Profile</h5>
                        <p class="card-text">Modifier les détails de votre compte</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="#">
                <div class="card h-100 client-card">
                    <div class="card-body text-center">
                    <i class="fas fa-box card-icon"></i>
                        <h5 class="card-title">Vos commandes</h5>
                        <p class="card-text">Afficher toutes les commandes passées</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="#">
                <div class="card h-100 client-card">
                    <div class="card-body text-center">
                        <i class="fas fa-address-card card-icon"></i>
                        <h5 class="card-title">Adresses</h5>
                        <p class="card-text">Modifier les adresses et les préférences de livraison des commandes et des cadeaux</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col">
            <a href="#">
                <div class="card h-100 client-card">
                    <div class="card-body text-center">
                        <i class="fas fa-phone card-icon"></i>
                        <h5 class="card-title">Nous contacter</h5>
                        <p class="card-text">Contacter notre service client par téléphone ou par mail</p>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>
</section>

<!--edit section-->
<div class="d-flex flex-column min-vh-100">
<section class="edit-section">
<div class="container">
<div class="col-md-12">
    <div id="client-section">
        {% if app.user %}
        <form id="clientProfile" method="POST" action="/clients/update" style="display: none;" enctype="multipart/form-data">
            <input type="hidden" name="action" value="update">
            <!-- <input type="hidden" name="clId" value="<?php echo $clientId; ?>"> -->
            <div class="row mb-3">
                <div class="form-group col-md-6">
                    <input type="text" class="form-control mb-2" id="fullname" name="fullname" value="{{ app.user.userNom }}">
                </div>
                <div class="form-group col-md-6">
                    <input type="email" class="form-control mb-2" id="email" name="email" value="{{ app.user.email }}">
                </div>
            </div>
            <div class="row mb-3">
                <div class="form-group col-md-6">
                    <input type="password" class="form-control mb-2" id="password" name="password" placeholder="mot de pass">
                </div>
                <div class="form-group col-md-6" style="position: relative;">
                    <input type="file" class="form-control" id="photo" name="photo" >
                    <span class="text-white" >
                        {{ app.user.userPhoto }}
                    </span>
                </div>
            </div>
            <div class="row mb-3">
                <div class="form-group col-md-6">
                    <input type="text" class="form-control mb-2" id="addresse" name="addresse" value="{{ app.user.addresse }}">
                </div>
                <div class="form-group col-md-6">
                    <input type="text" class="form-control mb-2" id="codePostal" name="codePostal" placeholder="codePostal"  value="{{ app.user.cp }}">
                </div>
            </div>
            <div class="row mb-3">
                <div class="form-group col-md-6">
                    <input type="text" class="form-control mb-2" id="tel" name="tel" value="{{ app.user.tel }}">
                </div>   
            </div>

            <button type="submit" class="btn btn-primary mt-3 mb-3">Update</button>
        </form>
        {% else %}
    <p>No user data available.</p>
    {% endif %}
    </div>


    <!-- user commands section -->
    <div class="card justify-content-center" >
        <div class="card-body">
          <div class="table-responsive">
            {% if app.user.commands is defined and app.user.commands is not empty %}
    <table class="table table-hover mb-0">
        <thead>
            <tr>
                <th scope="col">État de la Commande</th>
                <th scope="col">Date</th>
                <th scope="col">Total</th>
                <th scope="col">Plats Commandés</th>
            </tr>
        </thead>
        <tbody>
            {% for command in app.user.commands %}
                {% dump(command) %}
                <tr>
                    <td>{{ command.commandEtat }}</td>
                    <td>{{ command.commandDate|date('d-m-Y') }}</td>
                    <td>{{ command.total }} €</td>
                    <td>
                        {% for detail in command.details %}
                            {{ detail.plat.platNom }}
                            <br />
                        {% endfor %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>Aucune commande trouvée.</p>
{% endif %}

            
    </div>
</div>
</div>

    
</div>
</section>


{% endblock %}